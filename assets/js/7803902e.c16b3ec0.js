"use strict";(self.webpackChunkoptics_docs=self.webpackChunkoptics_docs||[]).push([[7614],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>N});var n=a(7294);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var l=n.createContext({}),i=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=i(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,s=e.mdxType,r=e.originalType,l=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),d=i(a),k=s,N=d["".concat(l,".").concat(k)]||d[k]||c[k]||r;return a?n.createElement(N,o(o({ref:t},m),{},{components:a})):n.createElement(N,o({ref:t},m))}));function N(e,t){var a=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=a.length,o=new Array(r);o[0]=k;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p[d]="string"==typeof e?e:s,o[1]=p;for(var i=2;i<r;i++)o[i]=a[i];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},7651:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7462);var s=a(7294),r=a(5999);const o=e=>{let{children:t,...a}=e;const o=(0,s.useRef)(null),[p,l]=(0,s.useState)(!1);return s.createElement("pre",(0,n.Z)({},a,{ref:o}),t,s.createElement("button",{type:"button","aria-label":(0,r.I)({id:"theme.CodeBlock.copyButtonAriaLabel",message:"Copy code to clipboard",description:"The ARIA label for copy code blocks button"}),className:"copy-button",onClick:()=>{o.current&&function(e,t){let{target:a=document.body}=void 0===t?{}:t;if("string"!=typeof e)throw new TypeError(`Expected parameter \`text\` to be a \`string\`, got \`${typeof e}\`.`);const n=document.createElement("textarea"),s=document.activeElement;n.value=e,n.setAttribute("readonly",""),n.style.contain="strict",n.style.position="absolute",n.style.left="-9999px",n.style.fontSize="12pt";const r=document.getSelection(),o=r.rangeCount>0&&r.getRangeAt(0);a.append(n),n.select(),n.selectionStart=0,n.selectionEnd=e.length;let p=!1;try{p=document.execCommand("copy")}catch{}n.remove(),o&&(r.removeAllRanges(),r.addRange(o)),s&&s.focus()}(Array.from(o.current.querySelectorAll("code div.line")).map((e=>e.textContent)).join("\n")),l(!0),setTimeout((()=>l(!1)),2e3)}},p?s.createElement(r.Z,{id:"theme.CodeBlock.copied",description:"The copied button label on code blocks"},"Copied"):s.createElement(r.Z,{id:"theme.CodeBlock.copy",description:"The copy button label on code blocks"},"Copy")))}},8273:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>p,toc:()=>i});var n=a(7462),s=(a(7294),a(3905));a(7651);const r={title:"Core Concepts",sidebar_position:3},o="Core Concepts",p={unversionedId:"Introduction/core-concepts",id:"Introduction/core-concepts",title:"Core Concepts",description:"As explained in the previous section it is useful to think of optics as references.",source:"@site/docs/Introduction/core-concepts.mdx",sourceDirName:"Introduction",slug:"/Introduction/core-concepts",permalink:"/optics-docs/docs/Introduction/core-concepts",draft:!1,editUrl:"https://github.com/TSOptics/optics-docs/edit/master/docs/Introduction/core-concepts.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Core Concepts",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Getting Started",permalink:"/optics-docs/docs/Introduction/getting-started"},next:{title:"Total/Partial",permalink:"/optics-docs/docs/Guides/total_partial"}},l={},i=[{value:"Decompose",id:"decompose",level:2},{value:"Methods",id:"methods",level:4},{value:"Compose",id:"compose",level:2},{value:"State graph",id:"state-graph",level:4},{value:"Decouple",id:"decouple",level:2},{value:"Roots and leaves",id:"roots-and-leaves",level:4},{value:"Conclusion",id:"conclusion",level:2}],m={toc:i},d="wrapper";function c(e){let{components:t,...a}=e;return(0,s.kt)(d,(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"core-concepts"},"Core Concepts"),(0,s.kt)("p",null,"As explained in the previous section it is useful to think of optics as references.",(0,s.kt)("br",{parentName:"p"}),"\n","In fact in Haskell, where the concept originated, they are often called ",(0,s.kt)("strong",{parentName:"p"},"functional references"),".\nThey point to parts of your application's immutable state and let you interact with it.",(0,s.kt)("br",{parentName:"p"}),"\n","This parallel is useful to grasp the core concepts of optics because just like references:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"they can be ",(0,s.kt)("strong",{parentName:"li"},"broken down")," into smaller parts by calling properties of the object they point to."),(0,s.kt)("li",{parentName:"ul"},"they can reference other optics and, in doing so, represent ",(0,s.kt)("strong",{parentName:"li"},"relations")," between your different states."),(0,s.kt)("li",{parentName:"ul"},"they can be passed around in your application, to your functions and components.")),(0,s.kt)("h2",{id:"decompose"},"Decompose"),(0,s.kt)("p",null,"We already saw that we can decompose, or break down, an optic into smaller parts by calling properties of the object they point to."),(0,s.kt)("div",{className:"shiki-twoslash-fragment"}),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanneAge: Optic<number, total>",style:{borderBottom:"solid 2px lightgrey"}},"onJeanneAge")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onUsers: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[], total>"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"["),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"1"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) age: Optic<number, total>"},"age")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},";")),(0,s.kt)("div",{parentName:"code",className:"meta-line"},(0,s.kt)("span",{parentName:"div",className:"popover-prefix"},"          "),(0,s.kt)("span",{parentName:"div",className:"popover"},(0,s.kt)("div",{parentName:"span",className:"arrow"}),"const onJeanneAge: Optic<number, total>"))))),(0,s.kt)("p",null,"We access the index ",(0,s.kt)("inlineCode",{parentName:"p"},"1")," of the root optic and then the ",(0,s.kt)("inlineCode",{parentName:"p"},"age")," property, getting us a new optic focused on a narrower part of the initial state.",(0,s.kt)("br",{parentName:"p"}),"\n","It's what we call ",(0,s.kt)("strong",{parentName:"p"},"top-down decomposition"),", we start at the top from a root optic at and we break it down into its sub-parts as we go down the tree."),(0,s.kt)("p",null,"Now we can read and update this number ",(0,s.kt)("strong",{parentName:"p"},"independently of the surrounding state"),".\nIn fact we don't have to care if there's a surrounding state at all or if it's an optic direclty returned by ",(0,s.kt)("inlineCode",{parentName:"p"},"createState"),". Only what's currently focused matters."),(0,s.kt)("admonition",{type:"info"},(0,s.kt)("p",{parentName:"admonition"},"When deriving an optic in a component body it's better to wrap with in ",(0,s.kt)("inlineCode",{parentName:"p"},"useMemo")," to avoid recreating a new reference at every render."),(0,s.kt)("pre",{parentName:"admonition",className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanneAge: Optic<number, total>"},"onJeanneAge")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) useMemo<Optic<number, total>>(factory: () => Optic<number, total>, deps: React.DependencyList | undefined): Optic<number, total>\nimport useMemo"},"useMemo")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(() "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onUsers: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[], total>"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"["),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"1"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) age: Optic<number, total>"},"age")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", ["),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onUsers: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[], total>"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]);")))))),(0,s.kt)("p",null,"It also greatly simplifies immutable updates:\ninstead of having to shallow copy every level up to the one that interests us (the dreaded ",(0,s.kt)("em",{parentName:"p"},"spread operator pyramid of doom"),")\nwe just have to ",(0,s.kt)("strong",{parentName:"p"},"focus on the specific part")," we want to update and call ",(0,s.kt)("inlineCode",{parentName:"p"},"set")," on it."),(0,s.kt)("p",null,"Once we update the underlying value, the subscribers (usually components) will be notified, whether they subscribed to the ",(0,s.kt)("inlineCode",{parentName:"p"},"onJeanneAge")," optic or any other optic whose value would have changed due to the update."),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onUsers: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[], total>"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) subscribe<SubscribeOptions | undefined>(listener: (a: {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[]) => void, options?: SubscribeOptions | undefined): () => void"},"subscribe")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(() "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"var console: Console"},"console")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) Console.log(...data: any[]): void"},"log")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"users informations were updated"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},")); "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"// \u2705")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onUsers: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[], total>"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"["),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"0"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) subscribe<SubscribeOptions | undefined>(listener: (a: {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}) => void, options?: SubscribeOptions | undefined): () => void"},"subscribe")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(() "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"var console: Console"},"console")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) Console.log(...data: any[]): void"},"log")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"John\'s informations were updated"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},")); "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"// \u274c")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onUsers: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[], total>"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"["),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"1"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) subscribe<SubscribeOptions | undefined>(listener: (a: {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}) => void, options?: SubscribeOptions | undefined): () => void"},"subscribe")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(() "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"var console: Console"},"console")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) Console.log(...data: any[]): void"},"log")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"Jeanne\'s informations were updated"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},")); "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"// \u2705")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanneAge: Optic<number, total>"},"onJeanneAge")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) subscribe<SubscribeOptions | undefined>(listener: (a: number) => void, options?: SubscribeOptions | undefined): () => void"},"subscribe")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"((",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) age: number"},"age"),") "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"var console: Console"},"console")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) Console.log(...data: any[]): void"},"log")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},"`Jeanne's age was updated to ${"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) age: number"},"age")),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},"}`"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},")")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"); "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"// \u2705")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanneAge: Optic<number, total>"},"onJeanneAge")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) set(a: number | ((prev: number) => number)): void"},"set")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"33"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");"))))),(0,s.kt)("p",null,"Console output:"),(0,s.kt)("pre",{className:"shiki solarized-dark",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"undefined"}},"- users informations were updated")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"undefined"}},"- Jeanne's informations were updated")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"undefined"}},"- Jeanne's age was updated to 33"))))),(0,s.kt)("p",null,"John's subscriber was not notified because the former doesn't know about Jeanne or her age."),(0,s.kt)("admonition",{type:"caution"},(0,s.kt)("p",{parentName:"admonition"},"Don't use destructuring to derive new optics.",(0,s.kt)("br",{parentName:"p"}),"\n","They use proxies under the hood to return new optics from properties so the following won't work:"),(0,s.kt)("pre",{parentName:"admonition",className:"shiki solarized-dark",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," { "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"age"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"name"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," } "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"onJeanne"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},";")))))),(0,s.kt)("h4",{id:"methods"},"Methods"),(0,s.kt)("p",null,"Calling a property is not the only way to decompose an optic, just like references you can call methods on them.\nIt's a way to derive new optics not from a property but from a condition, a transformation, ..."),(0,s.kt)("p",null,"For example if we want to focus on the oldest user:"),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onOldestUser: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, partial>"},"onOldestUser")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onUsers: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[], total>"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) ArrayCombinators<{ name: string; age: number; address: { city: string; street: { name: string; number: number; }; }; }[], total, { name: string; age: number; address: { city: string; street: { name: string; number: number; }; }; }>.max(f: (a: {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}) => number): Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, partial>"},"max")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"((",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) user: {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}"},"user"),") "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) user: {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}"},"user")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) age: number"},"age")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onOldestUser: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, partial>"},"onOldestUser")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) get<GetStateOptions | undefined>(options?: GetStateOptions | undefined): {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n} | undefined"},"get")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(); "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'// { name: "John", age: 42, address: { ... } }')),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanneAge: Optic<number, total>"},"onJeanneAge")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) set(a: number | ((prev: number) => number)): void"},"set")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"80"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onOldestUser: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, partial>"},"onOldestUser")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) get<GetStateOptions | undefined>(options?: GetStateOptions | undefined): {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n} | undefined"},"get")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(); "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'// { name: "Jeanne", age: 80, address: { ... } }'))))),(0,s.kt)("p",null,"Here ",(0,s.kt)("inlineCode",{parentName:"p"},"onOldestUser")," will always point to the oldest user, so when we age poor Jeanne by 47 years, she becomes the oldest user and the optic points to her now."),(0,s.kt)("p",null,"While ",(0,s.kt)("inlineCode",{parentName:"p"},"max")," is only available when the focused type is an array, some methods are available to every optic."),(0,s.kt)("p",null,"One such method is ",(0,s.kt)("a",{parentName:"p",href:"../API/Methods/convert()"},(0,s.kt)("inlineCode",{parentName:"a"},"convert")),". It lets you perform a lossless conversion from the focused type to another.",(0,s.kt)("br",{parentName:"p"}),"\n","For example if we wanted to manipulate the user's street as a tuple instead of an object:"),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanneStreetTuple: Optic<readonly [string, number], total>"},"onJeanneStreetTuple")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanne: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, total>"},"onJeanne")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) address: Optic<{\n    city: string;\n    street: {\n        name: string;\n        number: number;\n    };\n}, total>"},"address")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) street: Optic<{\n    name: string;\n    number: number;\n}, total>"},"street")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) BaseCombinators<{ name: string; number: number; }, total>.convert<readonly [string, number]>(to: (a: {\n    name: string;\n    number: number;\n}) => readonly [string, number], from: (b: readonly [string, number]) => {\n    name: string;\n    number: number;\n}): Optic<readonly [string, number], total>"},"convert")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  ({ ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) name: string"},"name"),", ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) number: number"},"number")," }) "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," ["),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) name: string"},"name")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) number: number"},"number")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"] "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"as"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"type const = readonly [string, number]"},"const")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},",")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  ([",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) name: string"},"name"),", ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) number: number"},"number"),"]) "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," ({ "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) name: string"},"name")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) number: number"},"number")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," })")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");"))))),(0,s.kt)("p",null,"Here we passed two functions to ",(0,s.kt)("inlineCode",{parentName:"p"},"convert"),": one to transform the street object into a tuple, and a second one that does the reverse transformation (from tuple to object).",(0,s.kt)("br",{parentName:"p"}),"\n","Now we can manipulate the street as a tuple even though it is still represented as an object in the state."),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanneStreetTuple: Optic<readonly [string, number], total>"},"onJeanneStreetTuple")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) set(a: readonly [string, number] | ((prev: readonly [string, number]) => readonly [string, number])): void"},"set")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(([",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) name: string"},"name"),", ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) number: number"},"number"),"]) "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," ["),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) name: string"},"name")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) number: number"},"number")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"+"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"10"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]);")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanneStreetTuple: Optic<readonly [string, number], total>"},"onJeanneStreetTuple")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) get<GetStateOptions | undefined>(options?: GetStateOptions | undefined): readonly [string, number]"},"get")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(); "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'// ["Rue de Rivoli", 11]')),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanne: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, total>"},"onJeanne")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) address: Optic<{\n    city: string;\n    street: {\n        name: string;\n        number: number;\n    };\n}, total>"},"address")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) street: Optic<{\n    name: string;\n    number: number;\n}, total>"},"street")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) get<GetStateOptions | undefined>(options?: GetStateOptions | undefined): {\n    name: string;\n    number: number;\n}"},"get")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"(); "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'// { name: "Rue de Rivoli", number: 11 }'))))),(0,s.kt)("p",null,"You can check all the methods available to optics like ",(0,s.kt)("a",{parentName:"p",href:"../API/Methods/min()"},(0,s.kt)("inlineCode",{parentName:"a"},"min")),", ",(0,s.kt)("a",{parentName:"p",href:"../API/Methods/max()"},(0,s.kt)("inlineCode",{parentName:"a"},"max")),", ",(0,s.kt)("a",{parentName:"p",href:"../API/Methods/refine()"},(0,s.kt)("inlineCode",{parentName:"a"},"refine"))," or ",(0,s.kt)("a",{parentName:"p",href:"../API/Methods/convert()"},(0,s.kt)("inlineCode",{parentName:"a"},"convert"))," under the API section of this site."),(0,s.kt)("h2",{id:"compose"},"Compose"),(0,s.kt)("p",null,"We just saw that we can decompose optics (top-down) but we actually can also do the opposite,\nmeaning we can create new optics by composing already existing optics together (",(0,s.kt)("strong",{parentName:"p"},"bottom-up composition"),")."),(0,s.kt)("p",null,"To illustrate let's create a new organization with a name, and a list of employees:"),(0,s.kt)("div",{className:"shiki-twoslash-fragment"}),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onInterpol: Optic<{\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }, total>[];\n}, total>"},"onInterpol")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) createState<{\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }, total>[];\n}>(initialValue: {\n    name: string;\n    established: string;\n    employees: Optic<...>[];\n}, key?: string | undefined): Optic<...>\nimport createState"},"createState")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"({")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) name: string"},"name"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"Interpol"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},",")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) established: string"},"established"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"1923"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},",")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) employees: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, total>[]"},"employees"),": ["),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanne: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, total>"},"onJeanne")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJohn: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, total>"},"onJohn")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"],")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"});"))))),(0,s.kt)("p",null,"As you can see the employees we passed are not actual javascript objects but optics we created earlier."),(0,s.kt)("p",null,"When we call ",(0,s.kt)("inlineCode",{parentName:"p"},"get")," on interpol's optic it automatically ",(0,s.kt)("strong",{parentName:"p"},"denormalizes")," the result and replaces the optics by their respective state:"),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const interpol: {\n    name: string;\n    established: string;\n    employees: {\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }[];\n}"},"interpol")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onInterpol: Optic<{\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }, total>[];\n}, total>"},"onInterpol")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) get<GetStateOptions | undefined>(options?: GetStateOptions | undefined): {\n    name: string;\n    established: string;\n    employees: {\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }[];\n}"},"get")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"();")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"// {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//   name: "Interpol",')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//   established: "1923",')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//   employees: [")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//     { name: "Jeanne", age: 80, address: { ... } },')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//     { name: "John", age: 42, address: { ... } },')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//   ],")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"// }"))))),(0,s.kt)("p",null,"We have created a new state which is the composition of its own state and references to those of our two previous users."),(0,s.kt)("p",null,"If we update the state of one of the employees then it's like if the organization state was updated as well\nso its subscribers will be notified (will re-render if they are components)."),(0,s.kt)("p",null,"To illustrate let's give back Jeanne her youth:"),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onInterpol: Optic<{\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }, total>[];\n}, total>"},"onInterpol")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) employees: Optic<Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}, total>[], total>"},"employees")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) subscribe<SubscribeOptions | undefined>(listener: (a: {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[]) => void, options?: SubscribeOptions | undefined): () => void"},"subscribe")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"((",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) employees: {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[]"},"employees"),") "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"var console: Console"},"console")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) Console.log(...data: any[]): void"},"log")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},"`one of the ${"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) employees: {\n    name: string;\n    age: number;\n    address: {\n        city: string;\n        street: {\n            name: string;\n            number: number;\n        };\n    };\n}[]"},"employees")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},".",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) Array<{ name: string; age: number; address: {\n    city: string;\n    street: {\n        name: string;\n        number: number;\n    };\n}; }>.length: number"},"length")),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},"} employees was updated`"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},")")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onJeanneAge: Optic<number, total>"},"onJeanneAge")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) set(a: number | ((prev: number) => number)): void"},"set")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"32"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");"))))),(0,s.kt)("p",null,"Console output:"),(0,s.kt)("pre",{className:"shiki solarized-dark",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"undefined"}},"one of the 2 employees was updated"))))),(0,s.kt)("p",null,"Using optics in the state of an entity is a way to create ",(0,s.kt)("strong",{parentName:"p"},"relations")," between your different states.",(0,s.kt)("br",{parentName:"p"}),"\n","In a relational database we use foreign keys to represent relations between tables, here optics are used for the same purpose.\nIn SQL we use ",(0,s.kt)("strong",{parentName:"p"},"joins")," to get the final denormalized result, with optics it is done automatically."),(0,s.kt)("details",null,(0,s.kt)("summary",null,"Opt-out of denormalization"),"You can choose to get the normalized result instead, by setting the denormalize option to ",(0,s.kt)("code",null,"false")," when calling ",(0,s.kt)("code",null,"get"),":",(0,s.kt)("br",null),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const result: {\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }, total>[];\n}"},"result")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onInterpol: Optic<{\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }, total>[];\n}, total>"},"onInterpol")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) get<{\n    denormalize: false;\n}>(options?: {\n    denormalize: false;\n} | undefined): {\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }, total>[];\n}"},"get")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"({ ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) denormalize: false"},"denormalize"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#B58900"}},"false"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," });"))))),(0,s.kt)("p",null,"The type of the returned value will of course change depending on the value of ",(0,s.kt)("inlineCode",{parentName:"p"},"denormalize"),":"),(0,s.kt)("table",null,(0,s.kt)("thead",null,(0,s.kt)("tr",null,(0,s.kt)("th",{width:"700px"},"denormalize: false"),(0,s.kt)("th",{width:"700px"},"denormalize: true (default)"))),(0,s.kt)("tr",null,(0,s.kt)("td",null,(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const result: {\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }, total>[];\n}",style:{borderBottom:"solid 2px lightgrey"}},"result")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},";")),(0,s.kt)("div",{parentName:"code",className:"meta-line"},(0,s.kt)("span",{parentName:"div",className:"popover-prefix"},"  "),(0,s.kt)("span",{parentName:"div",className:"popover"},(0,s.kt)("div",{parentName:"span",className:"arrow"}),"const result: {\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }, total>[];\n}")))))),(0,s.kt)("td",null,(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const denormalizedResult: {\n    name: string;\n    established: string;\n    employees: {\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }[];\n}",style:{borderBottom:"solid 2px lightgrey"}},"denormalizedResult")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},";")),(0,s.kt)("div",{parentName:"code",className:"meta-line"},(0,s.kt)("span",{parentName:"div",className:"popover-prefix"},"        "),(0,s.kt)("span",{parentName:"div",className:"popover"},(0,s.kt)("div",{parentName:"span",className:"arrow"}),"const denormalizedResult: {\n    name: string;\n    established: string;\n    employees: {\n        name: string;\n        age: number;\n        address: {\n            city: string;\n            street: {\n                name: string;\n                number: number;\n            };\n        };\n    }[];\n}"))))))))),(0,s.kt)("h4",{id:"state-graph"},"State graph"),(0,s.kt)("p",null,"The organization has a reference to its employees but in turn indivual employee can also have references to other entities.",(0,s.kt)("br",{parentName:"p"}),"\n","First let's make cities a first-class citizen in our state:"),(0,s.kt)("div",{className:"shiki-twoslash-fragment"}),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"import"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," { "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) function createState<T>(initialValue: T, key?: string): Optic<T, total>\nimport createState"},"createState")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," } "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"from"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"@optics/react"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},";")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onParis: Optic<{\n    name: string;\n    inhabitants: number;\n}, total>"},"onParis")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) createState<{\n    name: string;\n    inhabitants: number;\n}>(initialValue: {\n    name: string;\n    inhabitants: number;\n}, key?: string | undefined): Optic<{\n    name: string;\n    inhabitants: number;\n}, total>\nimport createState"},"createState")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"({ ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) name: string"},"name"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"Paris"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) inhabitants: number"},"inhabitants"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"2_200_000"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," });")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onMilan: Optic<{\n    name: string;\n    inhabitants: number;\n}, total>"},"onMilan")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) createState<{\n    name: string;\n    inhabitants: number;\n}>(initialValue: {\n    name: string;\n    inhabitants: number;\n}, key?: string | undefined): Optic<{\n    name: string;\n    inhabitants: number;\n}, total>\nimport createState"},"createState")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"({ ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) name: string"},"name"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"Milan"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) inhabitants: number"},"inhabitants"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"1_400_000"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," });")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onNewYork: Optic<{\n    name: string;\n    inhabitants: number;\n}, total>"},"onNewYork")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) createState<{\n    name: string;\n    inhabitants: number;\n}>(initialValue: {\n    name: string;\n    inhabitants: number;\n}, key?: string | undefined): Optic<{\n    name: string;\n    inhabitants: number;\n}, total>\nimport createState"},"createState")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"({ ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) name: string"},"name"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"New York"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) inhabitants: number"},"inhabitants"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"8_500_000"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," });"))))),(0,s.kt)("p",null,"Then we can rework our initial state. Instead of representing a user's city with a string let's use an optic to reference a previously created city:"),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onUsers: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: Optic<{\n            name: string;\n            inhabitants: number;\n        }, total>;\n    };\n}[], total>"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) createState<{\n    name: string;\n    age: number;\n    address: {\n        city: Optic<{\n            name: string;\n            inhabitants: number;\n        }, total>;\n    };\n}[]>(initialValue: {\n    name: string;\n    age: number;\n    address: {\n        city: Optic<{\n            name: string;\n            inhabitants: number;\n        }, total>;\n    };\n}[], key?: string | undefined): Optic<...>\nimport createState"},"createState")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"([")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"    ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) name: string"},"name"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"John"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},",")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"    ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) age: number"},"age"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"42"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},",")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"    ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) address: {\n    city: Optic<{\n        name: string;\n        inhabitants: number;\n    }, total>;\n}"},"address"),": { ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) city: Optic<{\n    name: string;\n    inhabitants: number;\n}, total>"},"city"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onNewYork: Optic<{\n    name: string;\n    inhabitants: number;\n}, total>"},"onNewYork")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"    ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) name: string"},"name"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"Jeanne"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},",")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"    ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) age: number"},"age"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"32"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},",")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"    ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) address: {\n    city: Optic<{\n        name: string;\n        inhabitants: number;\n    }, total>;\n}"},"address"),": { ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) city: Optic<{\n    name: string;\n    inhabitants: number;\n}, total>"},"city"),": "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onParis: Optic<{\n    name: string;\n    inhabitants: number;\n}, total>"},"onParis")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]);"))))),(0,s.kt)("p",null,"Now the fully denormalized result from ",(0,s.kt)("inlineCode",{parentName:"p"},"onInterpol")," looks like that:"),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const interpol: {\n    name: string;\n    established: string;\n    employees: {\n        name: string;\n        age: number;\n        address: {\n            city: {\n                name: string;\n                inhabitants: number;\n            };\n        };\n    }[];\n}"},"interpol")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onInterpol: Optic<{\n    name: string;\n    established: string;\n    employees: Optic<{\n        name: string;\n        age: number;\n        address: {\n            city: Optic<{\n                name: string;\n                inhabitants: number;\n            }, total>;\n        };\n    }, total>[];\n}, total>"},"onInterpol")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) get<GetStateOptions | undefined>(options?: GetStateOptions | undefined): {\n    name: string;\n    established: string;\n    employees: {\n        name: string;\n        age: number;\n        address: {\n            ...;\n        };\n    }[];\n}"},"get")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"();")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"// {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//   name: "Interpol",')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//   established: "1923",')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//   employees: [")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//     {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//       name: "John",')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//       age: 42,")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//       address: {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//         city: {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//           name: "New York",')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//           inhabitants: 8_500_000,")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//         },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//       },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//     },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//     {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//       name: "Jeanne",')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//       age: 32,")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//       address: {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//         city: {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},'//           name: "Paris",')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//           inhabitants: 2_200_000,")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//         },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//       },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//     },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"//   ],")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"// }"))))),(0,s.kt)("p",null,"As you can see denormalization is recursive, meaning that if a referenced entity has references of its own, they will be denormalized as well."),(0,s.kt)("p",null,"You can update a relation by simply replacing the optic with another one.",(0,s.kt)("br",{parentName:"p"}),"\n","For example if Jeanne moves to Milan:"),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"ts"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onUsers: Optic<{\n    name: string;\n    age: number;\n    address: {\n        city: Optic<{\n            name: string;\n            inhabitants: number;\n        }, total>;\n    };\n}[], total>"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"["),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"1"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) address: Optic<{\n    city: Optic<{\n        name: string;\n        inhabitants: number;\n    }, total>;\n}, total>"},"address")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) city: Optic<Optic<{\n    name: string;\n    inhabitants: number;\n}, total>, total>"},"city")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) set(a: Optic<{\n    name: string;\n    inhabitants: number;\n}, total> | ((prev: Optic<{\n    name: string;\n    inhabitants: number;\n}, total>) => Optic<{\n    name: string;\n    inhabitants: number;\n}, total>)): void"},"set")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const onMilan: Optic<{\n    name: string;\n    inhabitants: number;\n}, total>"},"onMilan")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");"))))),(0,s.kt)("p",null,"Referencing other entities with optics allows us to represent our state as a ",(0,s.kt)("strong",{parentName:"p"},"graph"),",\nwhere the ",(0,s.kt)("strong",{parentName:"p"},"nodes")," are the entities we build with ",(0,s.kt)("inlineCode",{parentName:"p"},"createState")," and the ",(0,s.kt)("strong",{parentName:"p"},"edges")," are the optics we put in the state to make the relations."),(0,s.kt)("p",null,"While immutable state is great it however makes it hard to represent such graphs.",(0,s.kt)("br",{parentName:"p"}),"\n","We usually have to resort to representing the relation with the the id of the target entity and then doing what's essentially a manual join to get our denormalized result.",(0,s.kt)("br",{parentName:"p"}),"\n","Optics makes the whole process ",(0,s.kt)("strong",{parentName:"p"},"automatic"),", ",(0,s.kt)("strong",{parentName:"p"},"reactive")," and ",(0,s.kt)("strong",{parentName:"p"},"type-safe"),", which is fundamental for applications with non trivial client state,\nas most of them eventually need to represent relations between entities."),(0,s.kt)("admonition",{title:"cycles",type:"caution"},(0,s.kt)("p",{parentName:"admonition"},"We need our graph to be ",(0,s.kt)("strong",{parentName:"p"},"acyclic")," to avoid infinite loops when denormalizing.",(0,s.kt)("br",{parentName:"p"}),"\n","That means you can't have both the user referencing the city and the city referencing the user, one of them must exclusively ",(0,s.kt)("strong",{parentName:"p"},"own")," the relation. ",(0,s.kt)("sub",null,(0,s.kt)("sup",null,(0,s.kt)("i",null,"(I guess my ex was just mindful of graph cycles)")))),(0,s.kt)("p",{parentName:"admonition"},"In general it's better to abstain from making the graph overly complex as it can make it easy to accidently introduce cycles,\nas well as making denormalization slow (just like too many joins in SQL can degrade performance).")),(0,s.kt)("h2",{id:"decouple"},"Decouple"),(0,s.kt)("p",null,"Another pattern that optics encourages is ",(0,s.kt)("strong",{parentName:"p"},"decoupling")," your global state from your components."),(0,s.kt)("p",null,"It can be hard to do when dealing with external state because you might be inclined to import it directly in your components."),(0,s.kt)("p",null,"To illustrate let's use a fictitious ",(0,s.kt)("inlineCode",{parentName:"p"},"useStore")," hook implementing the commonly used pattern of selecting a part of the store from the root and subscribing to it:"),(0,s.kt)("pre",{className:"shiki solarized-dark",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"tsx"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"import"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," { "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"useStore"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," } "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"from"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"./myStore"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},";")),(0,s.kt)("div",{parentName:"code",className:"line"}),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"User"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," () "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"user"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"useStore"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"((state) "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"state"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"users"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"["),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"0"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]);")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"};"))))),(0,s.kt)("p",null,"Here, as noted by the import of the store at line 1, we ",(0,s.kt)("strong",{parentName:"p"},"coupled")," our component to the store.",(0,s.kt)("br",{parentName:"p"}),"\n","The ",(0,s.kt)("inlineCode",{parentName:"p"},"User")," component will get the user from the same store, using the same path every time.\nWe can't ",(0,s.kt)("strong",{parentName:"p"},"reuse the component")," to render any another user."),(0,s.kt)("p",null,"Coupling hurts reusability but also ",(0,s.kt)("strong",{parentName:"p"},"testability"),": we can't easily render the component in isolation (inside a Storybook, a unit test, ...)\nsince we need to carry with us the surrounding context that the selector needs to get the data."),(0,s.kt)("p",null,"And that's where lies the problem, ",(0,s.kt)("strong",{parentName:"p"},"the component shouldn't have to know the shape of the global state"),".",(0,s.kt)("br",{parentName:"p"}),"\n","Its only job should be rendering a user, no matter where it comes from."),(0,s.kt)("admonition",{type:"info"},(0,s.kt)("p",{parentName:"admonition"},"We could split our component into ",(0,s.kt)("em",{parentName:"p"},"smart")," and ",(0,s.kt)("em",{parentName:"p"},"dumb")," ones (or ",(0,s.kt)("em",{parentName:"p"},"container")," and ",(0,s.kt)("em",{parentName:"p"},"presentational"),") to keep the dumb component decoupled from the state,\nbut at the cost of additional verbosity and nesting in the component tree.")),(0,s.kt)("p",null,"That's where optics come in, as they allow us to naturally decouple our components from the global state simply by passing them to the component's props:"),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"tsx"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"interface"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#CB4B16"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"interface UserProps"},"UserProps")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) UserProps.onUser: Optic<User>"},"onUser")),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#CB4B16"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) type Optic<A, TOpticType extends OpticType = total> = _ReadOptic<A, TOpticType> & {\n    set(a: A | ((prev: A) => A)): void;\n} & OpticDeriveFromProps<A, TOpticType, NonNullable<A>> & BaseCombinators<...> & (IsAny<...> extends true ? {} : CombinatorsForType<...>) & CombinatorsForOpticType<...>\nimport Optic"},"Optic")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"<"),(0,s.kt)("span",{parentName:"div",style:{color:"#CB4B16"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"type User = {\n    name: string;\n    age: number;\n    address: {\n        city: Optic<{\n            name: string;\n            inhabitants: number;\n        }, total>;\n    };\n}"},"User")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},">;")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"}")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const User: ({ onUser }: UserProps) => void"},"User")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," ({ ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) onUser: Optic<User>"},"onUser")," }"),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#CB4B16"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"interface UserProps"},"UserProps")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},") "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," ["),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const user: {\n    name: string;\n    age: number;\n    address: {\n        city: {\n            name: string;\n            inhabitants: number;\n        };\n    };\n}"},"user")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const setUser: React.Dispatch<React.SetStateAction<User>>"},"setUser")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"] "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) useOptic<User, total, GetStateOptions | undefined>(optic: Optic<User, total>, options?: GetStateOptions | undefined): [...]\nimport useOptic"},"useOptic")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) onUser: Optic<User>"},"onUser")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"};"))))),(0,s.kt)("p",null,"Now the User component can be passed ",(0,s.kt)("strong",{parentName:"p"},"any optic")," focused on a user, allowing you to ",(0,s.kt)("strong",{parentName:"p"},"reuse it")," anywhere in your application."),(0,s.kt)("pre",{className:"shiki solarized-dark",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"tsx"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"<"),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"User"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"onUser"),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"{"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"onJeanne"),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"}"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"/>")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"<"),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"User"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"onUser"),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"{"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"onJohn"),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"}"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"/>"))))),(0,s.kt)("p",null,"When testing you can create a new throwaway user just for your test needs, without having to worry about the rest of the global state:"),(0,s.kt)("pre",{className:"shiki solarized-dark",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"tsx"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"import"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," { "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"render"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," } "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"from"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"@testing-library/*"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},";")),(0,s.kt)("div",{parentName:"code",className:"line"}),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"test"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"User renders a user"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", () "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"onTestUser"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"createState"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"({ name: "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"Vincent"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", age: "),(0,s.kt)("span",{parentName:"div",style:{color:"#D33682"}},"29"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", address: { "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"..."),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," } });")),(0,s.kt)("div",{parentName:"code",className:"line"}),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"render"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"<"),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"User"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"onUser"),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"{"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},"onTestUser"),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"}"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"/>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"});"))))),(0,s.kt)("p",null,"Listing dependencies in the props is always recommended to avoid coupling and there's no reason that it should be otherwise for global state !"),(0,s.kt)("h4",{id:"roots-and-leaves"},"Roots and leaves"),(0,s.kt)("p",null,"Of course not all components can get their optics through their props as we have to start somewhere with some initial optics.\nThus components close to the root usually import optics directly:"),(0,s.kt)("pre",{className:"shiki solarized-dark twoslash lsp",style:{backgroundColor:"#002B36",color:"#839496"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"tsx"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"import"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," { "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) const onUsers: Optic<User[]>\nimport onUsers"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," } "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"from"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#2AA198"}},'"./users"'),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},";")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const UserList: () => React.JSX.Element"},"UserList")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," () "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"const"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," ["),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const users: {\n    name: string;\n    age: number;\n    address: {\n        city: {\n            name: string;\n            inhabitants: number;\n        };\n    };\n}[]"},"users")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},", "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const setUsers: React.Dispatch<React.SetStateAction<User[]>>"},"setUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"] "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) useOptic<User[], total, GetStateOptions | undefined>(optic: Optic<User[], total>, options?: GetStateOptions | undefined): [...]\nimport useOptic"},"useOptic")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"("),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) const onUsers: Optic<User[]>\nimport onUsers"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},");")),(0,s.kt)("div",{parentName:"code",className:"line"},"\xa0"),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"return"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," (")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"<"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) JSX.IntrinsicElements.ul: React.DetailedHTMLProps<React.HTMLAttributes<HTMLUListElement>, HTMLUListElement>"},"ul")),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},">")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"      "),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"{"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"const users: {\n    name: string;\n    age: number;\n    address: {\n        city: {\n            name: string;\n            inhabitants: number;\n        };\n    };\n}[]"},"users")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(method) Array<{ name: string; age: number; address: { city: { name: string; inhabitants: number; }; }; }>.map<React.JSX.Element>(callbackfn: (value: {\n    name: string;\n    age: number;\n    address: {\n        city: {\n            name: string;\n            inhabitants: number;\n        };\n    };\n}, index: number, array: {\n    name: string;\n    age: number;\n    address: {\n        city: {\n            name: string;\n            inhabitants: number;\n        };\n    };\n}[]) => React.JSX.Element, thisArg?: any): React.JSX.Element[]"},"map")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"((",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) user: {\n    name: string;\n    age: number;\n    address: {\n        city: {\n            name: string;\n            inhabitants: number;\n        };\n    };\n}"},"user"),", ",(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) index: number"},"index"),") "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},"=>"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," (")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"        "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"<"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) JSX.IntrinsicElements.li: React.DetailedHTMLProps<React.LiHTMLAttributes<HTMLLIElement>, HTMLLIElement>"},"li")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) React.Attributes.key?: React.Key | null | undefined"},"key")),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"{"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) user: {\n    name: string;\n    age: number;\n    address: {\n        city: {\n            name: string;\n            inhabitants: number;\n        };\n    };\n}"},"user")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"."),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) name: string"},"name")),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"}"),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},">")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"          "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"<"),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"\nimport User\nconst User: React.FC<{\n    onUser: Optic<User>;\n}>"},"User")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#93A1A1"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) onUser: Optic<User>"},"onUser")),(0,s.kt)("span",{parentName:"div",style:{color:"#859900"}},"="),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"{"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(alias) const onUsers: Optic<User[]>\nimport onUsers"},"onUsers")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"["),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(parameter) index: number"},"index")),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"]"),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"}"),(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"/>")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"        "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"</"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) JSX.IntrinsicElements.li: React.DetailedHTMLProps<React.LiHTMLAttributes<HTMLLIElement>, HTMLLIElement>"},"li")),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},">")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"      ))"),(0,s.kt)("span",{parentName:"div",style:{color:"#D30102"}},"}")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},"</"),(0,s.kt)("span",{parentName:"div",style:{color:"#268BD2"}},(0,s.kt)("data-lsp",{parentName:"span",lsp:"(property) JSX.IntrinsicElements.ul: React.DetailedHTMLProps<React.HTMLAttributes<HTMLUListElement>, HTMLUListElement>"},"ul")),(0,s.kt)("span",{parentName:"div",style:{color:"#586E75"}},">")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"  );")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#839496"}},"};"))))),(0,s.kt)("p",null,"But now that we have the optic imported we can derive new ones from it and pass them down to the ",(0,s.kt)("inlineCode",{parentName:"p"},"User")," elements.",(0,s.kt)("br",{parentName:"p"}),"\n","In turn we can imagine that the ",(0,s.kt)("inlineCode",{parentName:"p"},"User")," component derives an optic focused on the user's street and pass it down to a ",(0,s.kt)("inlineCode",{parentName:"p"},"StreetForm")," element, etc ..."),(0,s.kt)("p",null,"That way ",(0,s.kt)("strong",{parentName:"p"},"most leaf components can be decoupled")," from the global state, which is convenient as they are the ones that usually need to be reused, tested or documented in stories."),(0,s.kt)("h2",{id:"conclusion"},"Conclusion"),(0,s.kt)("p",null,"Now that you've learned how to ",(0,s.kt)("strong",{parentName:"p"},"decompose"),", ",(0,s.kt)("strong",{parentName:"p"},"compose")," your state, and ",(0,s.kt)("strong",{parentName:"p"},"decouple")," your components from it,\nyou know every important concept there is to know about state management with optics."),(0,s.kt)("p",null,"To further your knowledge you can go through the following guides:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"../Guides/total_partial"},"total and partial"),": understand how a total optic will always yield a value while it might not be the case for a partial one."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"../Guides/map_reduce"},"Map/Reduce"),": learn how to focus multiple values at a time, and then how to ",(0,s.kt)("strong",{parentName:"li"},"reduce")," the focus back a single value."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"../Guides/forms"},"Forms"),": learn how to build performant and scalable forms by controlling your inputs with optics.")))}c.isMDXComponent=!0}}]);